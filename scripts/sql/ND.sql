--Volver a probar de enviar eventos y ver repeticiones?
select id, tracking_number, status, substatus, date_created, last_updated, date_shipped, date_delivered, shipping_mode, service_id, speed
from shp_w01.shipment
where tracking_number in ('PD458750220BR',
'PD460767025BR',
'PD460774304BR',
'PD458746738BR',
'PD460950233BR');

select *
from shp_w01.tracking_events
where tracking_Number in ('PD458750220BR',
'PD460767025BR',
'PD460774304BR',
'PD458746738BR',
'PD460950233BR')
order by tracking_number, event_date desc;
----------------------------------------------------------------

select id, tracking_number, status, substatus, date_created, last_updated, date_shipped, date_delivered, shipping_mode, service_id, speed, date_shipped + speed
from shp_w01.shipment
where tracking_number in ('PD469153280BR','PD469199264BR','PD458702502BR','PD461110924BR','PD467300569BR','PD458739290BR','PD471635419BR','PD469191265BR','PD445536418BR','PD458750202BR','PD458387814BR','PD461042699BR','PD469138702BR','PD459745155BR','PD464451905BR','PD455204242BR','PD460762076BR','PD466067998BR','PD460919009BR','PD453906061BR','PD458339561BR','PD458779682BR','PD458430720BR','PD460774834BR','PD455115383BR','PD454035437BR','PD458454045BR','PD458802695BR','PD452301608BR','PD469592175BR','PD460917745BR','PD469020717BR','PD451659861BR','PD460011390BR','PD469153404BR','PD455130142BR','PD460957130BR','PD455416295BR','PD458397547BR','PD458741280BR','PD460719651BR','PD469210375BR','PD458384472BR','PD461118962BR','PD471612483BR','PD452675021BR','PD455360052BR','PD458384225BR','PD460712809BR','PD467392914BR','PD469208385BR','PD458373801BR','PD460813144BR','PD454494999BR','PD458714528BR','PD455219088BR','PD455173222BR','PD469132735BR','PD455075582BR','PD455142123BR','PD471787533BR','PD458761165BR','PD469219437BR','PD458802390BR','PD461189487BR','PD458368885BR','PD455149648BR','PD455199499BR','PD455185693BR','PD467399648BR','PD455070775BR','PD455191376BR','PD452953683BR','PD455164248BR','PD450931040BR','PD458386439BR','PD460780018BR','PD458735514BR','SW893501397BR','PD460708407BR','PD455145116BR','PD453001091BR','PD458729235BR','PD458390800BR','PD455398985BR','PD455143322BR','PD455143883BR','PD460766634BR','PD460753468BR','PD455165739BR','PD453906804BR','PD458380949BR','PD458723374BR','PD458686977BR','PD449645360BR','PD454503038BR','SW890715813BR','PD459733041BR','SW891562257BR','PD465868330BR','PD453816026BR','PD455077455BR','PD458791635BR','PD458376241BR','PD460650790BR','SW893224535BR','PD467293430BR');

select tracking_number, count(*)
from shp_w01.tracking_events
where tracking_Number in ('PD469153280BR','PD469199264BR','PD458702502BR','PD461110924BR','PD467300569BR','PD458739290BR','PD471635419BR','PD469191265BR','PD445536418BR','PD458750202BR','PD458387814BR','PD461042699BR','PD469138702BR','PD459745155BR','PD464451905BR','PD455204242BR','PD460762076BR','PD466067998BR','PD460919009BR','PD453906061BR','PD458339561BR','PD458779682BR','PD458430720BR','PD460774834BR','PD455115383BR','PD454035437BR','PD458454045BR','PD458802695BR','PD452301608BR','PD469592175BR','PD460917745BR','PD469020717BR','PD451659861BR','PD460011390BR','PD469153404BR','PD455130142BR','PD460957130BR','PD455416295BR','PD458397547BR','PD458741280BR','PD460719651BR','PD469210375BR','PD458384472BR','PD461118962BR','PD471612483BR','PD452675021BR','PD455360052BR','PD458384225BR','PD460712809BR','PD467392914BR','PD469208385BR','PD458373801BR','PD460813144BR','PD454494999BR','PD458714528BR','PD455219088BR','PD455173222BR','PD469132735BR','PD455075582BR','PD455142123BR','PD471787533BR','PD458761165BR','PD469219437BR','PD458802390BR','PD461189487BR','PD458368885BR','PD455149648BR','PD455199499BR','PD455185693BR','PD467399648BR','PD455070775BR','PD455191376BR','PD452953683BR','PD455164248BR','PD450931040BR','PD458386439BR','PD460780018BR','PD458735514BR','SW893501397BR','PD460708407BR','PD455145116BR','PD453001091BR','PD458729235BR','PD458390800BR','PD455398985BR','PD455143322BR','PD455143883BR','PD460766634BR','PD460753468BR','PD455165739BR','PD453906804BR','PD458380949BR','PD458723374BR','PD458686977BR','PD449645360BR','PD454503038BR','SW890715813BR','PD459733041BR','SW891562257BR','PD465868330BR','PD453816026BR','PD455077455BR','PD458791635BR','PD458376241BR','PD460650790BR','SW893224535BR','PD467293430BR')
and tracking_status like 'ND11'
group by tracking_number;
order by tracking_number, event_date desc;


select *
from shp_w01.tracking_status
where status_id like 'BDI01'
order by description, service_id, status_id;

select id, tracking_number, status, substatus, date_created, last_updated, date_shipped, date_delivered, date_first_printed, date_not_delivered, shipping_mode, service_id, speed, order_id
from shp_w01.shipment
where tracking_number in 
--('DF864111448BR','DF864116272BR','DF864116476BR','DF864117539BR','DF865254142BR','DF865714983BR','DF866164797BR','DF866171395BR','DF869132436BR','DF869812425BR','DF869941098BR','DF870339897BR','DF870499015BR','DF870585853BR','DF870912195BR','DF871611550BR','DF875979818BR','DF876075354BR','DF876281625BR','DF877043738BR','DF878730123BR','DF879094595BR','DF879134462BR','DF879161627BR','DF879226141BR','DF879247115BR','DF879356566BR','DF879483785BR','DF879877045BR','DF880094417BR','DF880213318BR','DF882136605BR','DF882142203BR','DF882675508BR','DF883143369BR','DF883185868BR','DF883680699BR','DF884127464BR','DF884186595BR','DF884229857BR','DF885247154BR','DF885315248BR','DF887510196BR','DF893331463BR','DF908019149BR','DF908551905BR','DF912303312BR','DF913148985BR','DF914736789BR','DF916517097BR','DF916540515BR','DF916762614BR','DF916838220BR','DG000088682BR','DL960230495BR','DL960231332BR','DL960232196BR','DL960232797BR','DL960232995BR','DL960233214BR','DL960233280BR','DL972074033BR','DL985024804BR','PB729961817BR','PD103624776BR','PD119997753BR','PD128194865BR','PD128742734BR','PD130516285BR','PD142717483BR','PD142966675BR','PD143391394BR','PD143533296BR','PD147847026BR','PD150112339BR','PD240150975BR','PG022822927BR','PG124580545BR','PG153693774BR','PG193437690BR','PG200536032BR','PG344054195BR','PG393250315BR','PG398864823BR','PG425350737BR','PG434038139BR','PG447552121BR','PG500825117BR','PG694164364BR','PG694164378BR','PG694360001BR','PG695646270BR','PG702894331BR','PG707364004BR','PG717398909BR','PG731881468BR','PG743227505BR','PG743233046BR','PG745436421BR','PG748161301BR','SA290968895BR','SA292056057BR','SA351971970BR','SA487586548BR','SA597316123BR','SA644496409BR','SA814403284BR','SG119470635BR','SW037041873BR','SW064148171BR','SW157721731BR','SW179432759BR','SW184641936BR','SW185286454BR','SW225221649BR','SW225221652BR','SW225221697BR','SW251004965BR','SW320770142BR','SW337111895BR','SW357280028BR','SW366611709BR','SW452734382BR','SW482189006BR','SW487662195BR','SW507968906BR','SW531736902BR','SW531736916BR','SW584472487BR','SW630042487BR','SW482189006BR','DF912515776BR','DF916512727BR','DF916520175BR','DF916521803BR','DF916556113BR','DF916825169BR','PG724666693BR','PG724666702BR','PG724666716BR','DF882563957BR','DL984328662BR','PB729961817BR','PD119196134BR','PD138052518BR','PD143233402BR','PD143883663BR','PD146004341BR','PG112480179BR','PG136878376BR','PG338804779BR','PG356103168BR','PG387241819BR','PG434027480BR','PG459228669BR','PG473710744BR','PG479749045BR','PG496338164BR','PG499053254BR','PG743232099BR','PG743232690BR','PG769122997BR','DF876281625BR','DF877043738BR','DF879483785BR','DF880396704BR','DF882136605BR','DF882563957BR','DF906147370BR','DF912481539BR','DF916540515BR','PB729961817BR','PD119992155BR','PG344054195BR','PG500825117BR','PG717398909BR','PG718818942BR','SW487662195BR','SW584472487BR','PD128194865BR','PD138052518BR','PD143391394BR','PD143533296BR','PG022822927BR','PG136878376BR','PG356103168BR','PG459228669BR','PG479749045BR','PG499053254BR','PG743227505BR','PG743232099BR','PG743232139BR','SA246330145BR','SA487586548BR','SA597316123BR','SA814403284BR','SW157721731BR','SW185286454BR','SW225221649BR','SW225221652BR','SW225221697BR','SW251004965BR','SW337111895BR','SW531736902BR','SW531736916BR','DF866085839BR','DF879134462BR','DF879161627BR','DF879356566BR','DF882142203BR','DF882563957BR','DF883143369BR','PD142966675BR','PD143233402BR','PD146004341BR','PD147847026BR','PG124580545BR','PG153693774BR','PG193437690BR','PG473710744BR','PG500825117BR','PG694164364BR','PG694164378BR','PG743232690BR','PG769122997BR','SA292056057BR','SW179432759BR','SW357280028BR','SW487662195BR','DF879094595BR','DF882136605BR','DF883185868BR','DF883680699BR','DF884127464BR','DF884186595BR','DF884215416BR','DF884229857BR','DF884701452BR','DF885247154BR','DF887510196BR','PD143883663BR','PD150112339BR','PD151076227BR','PG743233046BR','SA290968895BR','SA351971970BR','SW320770142BR','SW507968906BR','DF870339897BR','DL960230495BR','DL960232196BR','DF879226141BR','DF879483785BR','DF879877045BR','DF880094417BR','DF880213318BR','DF880396704BR','DF882675508BR','DL985024804BR','DF864111448BR','DF864116272BR','DF864117539BR','DF869812425BR','DL960231332BR','DL960232797BR','DL960232995BR','DL960233214BR','DL960233280BR','PD103624776BR','PD119196134BR','PD119992155BR','PD128742734BR','PG387241819BR','PG434027480BR','PG718818942BR','PG731881468BR','SW037041873BR','SW064148171BR','DF864116476BR','DF869941098BR','DF870499015BR','DF870585853BR','PD119997753BR','PG338804779BR','SW184641936BR','DF869132436BR','DF871611550BR','DF875979818BR','DL972074033BR','PB729961817BR','PD130516285BR','PG447552121BR','PG748161301BR','SG119470635BR','SW366611709BR','SW584472487BR','DF865254142BR','DF865714983BR','DF866171395BR','DF870912195BR','DF876075354BR','PG112480179BR','PG200536032BR','PG695646270BR','PG707364004BR','PG724666693BR','PG724666702BR','PG724666716BR','PG745436421BR','SA644496409BR','DF877043738BR','DF878730123BR','DF879247115BR','DL984328662BR','PD142717483BR','PG344054195BR','SW452734382BR','DF866164797BR','DF876281625BR','DF914736789BR','SW482189006BR','DF916517097BR','DF912515776BR','DF916512727BR','DF916838220BR','DF916540515BR','DF916556113BR','DF916521803BR','DF916520175BR','DF916825169BR','DF916762614BR','PD240150975BR','DF912303312BR','PG496338164BR','PG769122997BR','PG743232690BR','PG743232099BR','PG718818942BR','PG499053254BR','PG496338164BR','PG479749045BR','PG473710744BR','PG459228669BR','PG387241819BR','PG356103168BR','PG136878376BR','PD146004341BR','PD143883663BR','PD143233402BR','PD138052518BR','PD119992155BR','DL984328662BR','DF912481539BR','DF906147370BR','DF884701452BR','DF880396704BR','DF879247115BR','SW487662195BR','SW452734382BR','SW225221649BR','SW179432759BR','SW037041873BR','SA644496409BR','SA351971970BR','SA246330145BR','PG344054195BR','PD143533296BR','PD143391394BR','PD128742734BR','PD119997753BR','PD103624776BR','DL985024804BR','DL972074033BR','DL960233280BR','DL960233214BR','DL960231332BR','DG000088682BR','DF916540515BR','DF913148985BR','DF882563957BR','DF882136605BR','DF880213318BR','DF879877045BR','DF870912195BR','DF866171395BR','DF866164797BR','DF865714983BR','DF864117539BR','DF864111448BR','PG434027480BR','DF884701452BR','SA246330145BR');
('DF913709535BR');

select tracking_number, event_date, tracking_description, tracking_status, count_repeat, date_created, last_updated, application_id
from shp_w01.tracking_events
where tracking_Number in 
--('DF864111448BR','DF864116272BR','DF864116476BR','DF864117539BR','DF865254142BR','DF865714983BR','DF866164797BR','DF866171395BR','DF869132436BR','DF869812425BR','DF869941098BR','DF870339897BR','DF870499015BR','DF870585853BR','DF870912195BR','DF871611550BR','DF875979818BR','DF876075354BR','DF876281625BR','DF877043738BR','DF878730123BR','DF879094595BR','DF879134462BR','DF879161627BR','DF879226141BR','DF879247115BR','DF879356566BR','DF879483785BR','DF879877045BR','DF880094417BR','DF880213318BR','DF882136605BR','DF882142203BR','DF882675508BR','DF883143369BR','DF883185868BR','DF883680699BR','DF884127464BR','DF884186595BR','DF884229857BR','DF885247154BR','DF885315248BR','DF887510196BR','DF893331463BR','DF908019149BR','DF908551905BR','DF912303312BR','DF913148985BR','DF914736789BR','DF916517097BR','DF916540515BR','DF916762614BR','DF916838220BR','DG000088682BR','DL960230495BR','DL960231332BR','DL960232196BR','DL960232797BR','DL960232995BR','DL960233214BR','DL960233280BR','DL972074033BR','DL985024804BR','PB729961817BR','PD103624776BR','PD119997753BR','PD128194865BR','PD128742734BR','PD130516285BR','PD142717483BR','PD142966675BR','PD143391394BR','PD143533296BR','PD147847026BR','PD150112339BR','PD240150975BR','PG022822927BR','PG124580545BR','PG153693774BR','PG193437690BR','PG200536032BR','PG344054195BR','PG393250315BR','PG398864823BR','PG425350737BR','PG434038139BR','PG447552121BR','PG500825117BR','PG694164364BR','PG694164378BR','PG694360001BR','PG695646270BR','PG702894331BR','PG707364004BR','PG717398909BR','PG731881468BR','PG743227505BR','PG743233046BR','PG745436421BR','PG748161301BR','SA290968895BR','SA292056057BR','SA351971970BR','SA487586548BR','SA597316123BR','SA644496409BR','SA814403284BR','SG119470635BR','SW037041873BR','SW064148171BR','SW157721731BR','SW179432759BR','SW184641936BR','SW185286454BR','SW225221649BR','SW225221652BR','SW225221697BR','SW251004965BR','SW320770142BR','SW337111895BR','SW357280028BR','SW366611709BR','SW452734382BR','SW482189006BR','SW487662195BR','SW507968906BR','SW531736902BR','SW531736916BR','SW584472487BR','SW630042487BR','SW482189006BR','DF912515776BR','DF916512727BR','DF916520175BR','DF916521803BR','DF916556113BR','DF916825169BR','PG724666693BR','PG724666702BR','PG724666716BR','DF882563957BR','DL984328662BR','PB729961817BR','PD119196134BR','PD138052518BR','PD143233402BR','PD143883663BR','PD146004341BR','PG112480179BR','PG136878376BR','PG338804779BR','PG356103168BR','PG387241819BR','PG434027480BR','PG459228669BR','PG473710744BR','PG479749045BR','PG496338164BR','PG499053254BR','PG743232099BR','PG743232690BR','PG769122997BR','DF876281625BR','DF877043738BR','DF879483785BR','DF880396704BR','DF882136605BR','DF882563957BR','DF906147370BR','DF912481539BR','DF916540515BR','PB729961817BR','PD119992155BR','PG344054195BR','PG500825117BR','PG717398909BR','PG718818942BR','SW487662195BR','SW584472487BR','PD128194865BR','PD138052518BR','PD143391394BR','PD143533296BR','PG022822927BR','PG136878376BR','PG356103168BR','PG459228669BR','PG479749045BR','PG499053254BR','PG743227505BR','PG743232099BR','PG743232139BR','SA246330145BR','SA487586548BR','SA597316123BR','SA814403284BR','SW157721731BR','SW185286454BR','SW225221649BR','SW225221652BR','SW225221697BR','SW251004965BR','SW337111895BR','SW531736902BR','SW531736916BR','DF866085839BR','DF879134462BR','DF879161627BR','DF879356566BR','DF882142203BR','DF882563957BR','DF883143369BR','PD142966675BR','PD143233402BR','PD146004341BR','PD147847026BR','PG124580545BR','PG153693774BR','PG193437690BR','PG473710744BR','PG500825117BR','PG694164364BR','PG694164378BR','PG743232690BR','PG769122997BR','SA292056057BR','SW179432759BR','SW357280028BR','SW487662195BR','DF879094595BR','DF882136605BR','DF883185868BR','DF883680699BR','DF884127464BR','DF884186595BR','DF884215416BR','DF884229857BR','DF884701452BR','DF885247154BR','DF887510196BR','PD143883663BR','PD150112339BR','PD151076227BR','PG743233046BR','SA290968895BR','SA351971970BR','SW320770142BR','SW507968906BR','DF870339897BR','DL960230495BR','DL960232196BR','DF879226141BR','DF879483785BR','DF879877045BR','DF880094417BR','DF880213318BR','DF880396704BR','DF882675508BR','DL985024804BR','DF864111448BR','DF864116272BR','DF864117539BR','DF869812425BR','DL960231332BR','DL960232797BR','DL960232995BR','DL960233214BR','DL960233280BR','PD103624776BR','PD119196134BR','PD119992155BR','PD128742734BR','PG387241819BR','PG434027480BR','PG718818942BR','PG731881468BR','SW037041873BR','SW064148171BR','DF864116476BR','DF869941098BR','DF870499015BR','DF870585853BR','PD119997753BR','PG338804779BR','SW184641936BR','DF869132436BR','DF871611550BR','DF875979818BR','DL972074033BR','PB729961817BR','PD130516285BR','PG447552121BR','PG748161301BR','SG119470635BR','SW366611709BR','SW584472487BR','DF865254142BR','DF865714983BR','DF866171395BR','DF870912195BR','DF876075354BR','PG112480179BR','PG200536032BR','PG695646270BR','PG707364004BR','PG724666693BR','PG724666702BR','PG724666716BR','PG745436421BR','SA644496409BR','DF877043738BR','DF878730123BR','DF879247115BR','DL984328662BR','PD142717483BR','PG344054195BR','SW452734382BR','DF866164797BR','DF876281625BR','DF914736789BR','SW482189006BR','DF916517097BR','DF912515776BR','DF916512727BR','DF916838220BR','DF916540515BR','DF916556113BR','DF916521803BR','DF916520175BR','DF916825169BR','DF916762614BR','PD240150975BR','DF912303312BR','PG496338164BR','PG769122997BR','PG743232690BR','PG743232099BR','PG718818942BR','PG499053254BR','PG496338164BR','PG479749045BR','PG473710744BR','PG459228669BR','PG387241819BR','PG356103168BR','PG136878376BR','PD146004341BR','PD143883663BR','PD143233402BR','PD138052518BR','PD119992155BR','DL984328662BR','DF912481539BR','DF906147370BR','DF884701452BR','DF880396704BR','DF879247115BR','SW487662195BR','SW452734382BR','SW225221649BR','SW179432759BR','SW037041873BR','SA644496409BR','SA351971970BR','SA246330145BR','PG344054195BR','PD143533296BR','PD143391394BR','PD128742734BR','PD119997753BR','PD103624776BR','DL985024804BR','DL972074033BR','DL960233280BR','DL960233214BR','DL960231332BR','DG000088682BR','DF916540515BR','DF913148985BR','DF882563957BR','DF882136605BR','DF880213318BR','DF879877045BR','DF870912195BR','DF866171395BR','DF866164797BR','DF865714983BR','DF864117539BR','DF864111448BR','PG434027480BR','DF884701452BR','SA246330145BR')
('DF913709535BR')
order by tracking_number, event_date desc;



select count(*)
from shp_w01.shipment
where date_created > sysdate - 30
and status = 'shipped'
and site_id = 'MLB'
and shipping_mode = 'me2'
and date_delivered is not null;





select ship.id, ship.tracking_number, te1.event_date, te1.tracking_status, ts1.normalized_status, ts1.substatus
from shp_w01.shipment ship, shp_w01.shipment_tracking_events ste1, shp_w01.tracking_events te1, shp_w01.tracking_status ts1
where ste1.shipment_trackings_id= ship.id
and ste1.tracking_events_id = te1.id
and ts1.service_id = ship.service_id
and te1.tracking_status = ts1.status_id
and ship.id = (select id
from shp_w01.shipment
where order_id = '830183708')
order by te1.event_date desc;


select *
from shp_w01.shipment
where id = 21151805855;

select *
from shp_w01.shipping_service
where id in (21,22,23);
select to_char(sysdate, 'DD-MM-YY')
from dual;

select s.id
from shp_w01.shipment s
where s.date_created > sysdate - 30
and s.last_updated > sysdate - 7
and s.status = 'shipped'
and s.site_id = 'MLB'
and s.shipping_mode = 'me2'
and s.service_id in (21,22,23)
and exists (select 1 from shp_w01.tracking_events e where s.tracking_number = e.tracking_number and e.tracking_status in ('BDR00','BDI01','BDE01','BDE00','BDR01','BDI00'));

select *
from shp_w01.shipment s
where to_char(s.date_created, 'DD-MM-YY') = '10-03-14'
and s.status = 'shipped';

select *
from shp_w01.tracking_events e
where e.tracking_status in ('BDR00','BDI01','BDE01','BDE00','BDR01','BDI00')
and event_date > sysdate - 5
and exists (select 1 from shp_w01.shipment s where e.tracking_number = s.tracking_Number and s.status = 'shipped' and s.date_created > sysdate - 30);



select id,status_id, description, normalized_status, substatus
from shp_w01.tracking_status
where service_id in (21,22,23)
and status_id like 'ND%'
order by status_id;



