import grails.converters.JSON
import java.awt.geom.Point2D
import java.awt.geom.Point2D.Double

def location = "file:///home/fyanucio/workspace/shipping-frontend/webserver/post_offices.json".toURL()
def json = JSON.parse(location.text)

def keys = json.collect { it.key }

def total = 0
Set wrongAgencies = new HashSet()
for ( k in keys ) {

    def agenciesByState = json[k]
    total += agenciesByState.size()
    for ( agency in agenciesByState ) {
        try {
            Point2D agencyPoint = new Double(agency.latlng[0].toDouble(), agency.latlng[1].toDouble())

            if ( agency.latlng[0].toString().getChars().findAll{ it == '.' }.isEmpty() ) {
            //    wrongAgencies.add(agency)
            }
            if ( agency.latlng[1].toString().getChars().findAll{ it == '.' }.isEmpty() ) {
            //    wrongAgencies.add(agency)
            }
        } catch(NumberFormatException e) {
            wrongAgencies.add(agency)
        }
    }
}
println "TOTAL=${total}"
println "MAL=${wrongAgencies.size()}"
wrongAgencies.each { println it.title }
return null
